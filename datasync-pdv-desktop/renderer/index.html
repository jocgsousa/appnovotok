<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Gerenciamento - DataSync PDV</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="custom-header">
            <div class="title-bar">
                <div class="title">Sincronizador
                    <div class="sync-status">
                        <span id="status-indicator" class="status-stopped">‚óè</span>
                        <span id="status-text">Parado</span>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <!-- Bot√µes para abrir modais -->
            <section class="modal-buttons">
                <div class="button-group">
                    <button id="openConfigModal" class="btn btn-primary">‚öôÔ∏è Configura√ß√µes Globais</button>
                    <button id="openCaixaModal" class="btn btn-success">‚ûï Cadastrar Novo Caixa</button>
                </div>
            </section>

            <!-- Se√ß√£o de Lista de Caixas -->
            <section class="caixas-list">
                <h2>üìã Caixas Cadastrados</h2>
                <div class="list-actions">
                    <button id="selectAll" class="btn btn-secondary">‚úÖ Selecionar Todos</button>
        <button id="deselectAll" class="btn btn-secondary">‚ùå Desmarcar Todos</button>
        <button id="testAllConnections" class="btn btn-info">üîç Testar Todas as Conex√µes</button>
        <button id="startSync" class="btn btn-success">‚ñ∂Ô∏è Iniciar Sincroniza√ß√£o</button>
        <button id="stopSync" class="btn btn-danger">‚èπÔ∏è Parar Sincroniza√ß√£o</button>
                </div>
                <div id="caixasList" class="caixas-container">
                    <!-- Lista de caixas ser√° carregada aqui -->
                </div>
            </section>

            <!-- Se√ß√£o de Estat√≠sticas da API -->
            <section class="api-stats-section">
                <h2>üìä Estat√≠sticas da API</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total de Requisi√ß√µes</div>
                        <div class="stat-value" id="totalRequests">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Login</div>
                        <div class="stat-value" id="loginRequests">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Verificar Pedidos</div>
                        <div class="stat-value" id="checkRequests">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Enviar Pedidos para Api</div>
                        <div class="stat-value" id="sendPedidos">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Atualizar Status</div>
                        <div class="stat-value" id="updateStatus">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Inserir Requisi√ß√£o</div>
                        <div class="stat-value" id="insertRequest">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Tempo Ativo</div>
                        <div class="stat-value" id="uptime">00:00:00</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">√öltimo Reset</div>
                        <div class="stat-value" id="lastReset">-</div>
                    </div>
                </div>
                <div class="stats-actions">
                    <button id="refreshStats" class="btn btn-info">üîÑ Atualizar</button>
                    <button id="resetStats" class="btn btn-warning">üîÑ Resetar Contadores</button>
                </div>
            </section>

            <!-- Se√ß√£o de Logs -->
            <section class="logs-section">
                <h2>üìù Logs do Sistema</h2>
                <div id="logs" class="logs-container">
                    <p class="log-entry">Sistema iniciado. Aguardando a√ß√µes...</p>
                </div>
                <button id="clearLogs" class="btn btn-secondary">üóëÔ∏è Limpar Logs</button>
            </section>
        </main>
    </div>

    <!-- Modal de Configura√ß√µes Globais -->
    <div id="configModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚öôÔ∏è Configura√ß√µes Globais</h2>
                <span class="close" id="closeConfigModal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="config-grid">
                    <div class="form-group">
                        <label for="backendApiUrl">URL do Servidor Backend:</label>
                        <input type="text" id="backendApiUrl" value="http://localhost" placeholder="http://localhost">
                        <small class="form-help">URL base do servidor backend (sem porta)</small>
                    </div>
                    <div class="form-group">
                        <label for="backendApiPort">Porta do Servidor Backend:</label>
                        <input type="number" id="backendApiPort" min="1" max="65535" value="3333" placeholder="3333">
                        <small class="form-help">Porta do servidor backend (1-65535)</small>
                    </div>
                    <div class="form-group">
                        <label for="exdApiUrl">URL da API Externa:</label>
                        <input type="text" id="exdApiUrl" value="https://novotokapi.online/api/v1" placeholder="https://novotokapi.online/api/v1">
                        <small class="form-help">URL da API externa para sincroniza√ß√£o</small>
                    </div>
                    <div class="form-group">
                        <label for="exdUserApi">Usu√°rio da API Externa:</label>
                        <input type="text" id="exdUserApi" value="admin@gmail.com" placeholder="admin@gmail.com">
                        <small class="form-help">Usu√°rio para autentica√ß√£o na API externa</small>
                    </div>
                    <div class="form-group">
                        <label for="exdPassApi">Senha da API Externa:</label>
                        <input type="password" id="exdPassApi" value="@Ntkti1793" placeholder="Digite a senha">
                        <small class="form-help">Senha para autentica√ß√£o na API externa</small>
                    </div>
                    <div class="form-group">
                        <label for="checkInterval">Intervalo de Verifica√ß√£o (segundos):</label>
                        <input type="number" id="checkInterval" min="1" max="300" value="3" placeholder="3">
                        <small class="form-help">Intervalo entre verifica√ß√µes de requisi√ß√µes (1-300 segundos)</small>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="closeConfigModalBtn">Fechar</button>
                <button class="btn btn-primary" id="saveConfigBtn">üíæ Salvar Configura√ß√µes</button>
            </div>
        </div>
    </div>

    <!-- Modal de Cadastrar Novo Caixa -->
    <div id="caixaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="caixaModalTitle">‚ûï Cadastrar Novo Caixa</h2>
                <span class="close" id="closeCaixaModal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="caixaForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="nome">Nome do Caixa:</label>
                            <input type="text" id="nome" name="nome" required placeholder="Ex: Caixa 202">
                        </div>
                        <div class="form-group">
                            <label for="lcdbHost">Host do Banco:</label>
                            <input type="text" id="lcdbHost" name="lcdbHost" required placeholder="192.168.20.250:1521">
                        </div>
                        <div class="form-group">
                            <label for="lcdbUser">Usu√°rio do Banco:</label>
                            <input type="text" id="lcdbUser" name="lcdbUser" required placeholder="CAIXA">
                        </div>
                        <div class="form-group">
                            <label for="lcdbPass">Senha do Banco:</label>
                            <input type="password" id="lcdbPass" name="lcdbPass" required placeholder="CAIXA">
                        </div>
                        <div class="form-group">
                            <label for="lcdbName">Nome do Banco:</label>
                            <input type="text" id="lcdbName" name="lcdbName" required placeholder="XE">
                        </div>
                        <div class="form-group">
                            <label for="filial">Filial:</label>
                            <input type="number" id="filial" name="filial" required placeholder="2">
                        </div>
                        <div class="form-group">
                            <label for="caixa">N√∫mero do Caixa:</label>
                            <input type="number" id="caixa" name="caixa" required placeholder="202">
                        </div>
                        <div class="form-group">
                            <label for="milissegundos">Milissegundos:</label>
                            <input type="number" id="milissegundos" name="milissegundos" value="60000" required>
                        </div>
                        <div class="form-group">
                            <label for="syncInterval">Intervalo de Sync:</label>
                            <input type="number" id="syncInterval" name="syncInterval" value="60000" required>
                        </div>
                    </div>
                </form>
            </div>
            <!-- Se√ß√£o de Logs -->
            <div class="modal-logs">
                <h4>üìã Logs de Teste</h4>
                <div id="modalLogContainer" class="log-container">
                    <div class="log-placeholder">Nenhum log ainda. Clique em "Testar Conex√£o" para verificar a conectividade.</div>
                </div>
                <button type="button" class="btn btn-info" onclick="testCaixaConnectionInModal()">üîç Testar Conex√£o</button>
                <button type="button" class="btn btn-secondary" onclick="clearModalLogs()">üóëÔ∏è Limpar Logs</button>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeCaixaModal()">‚ùå Cancelar</button>
                <button type="button" id="cancelCaixaEdit" class="btn btn-warning" onclick="cancelEdit()" style="display: none;">üö´ Cancelar Edi√ß√£o</button>
                <button type="submit" id="saveCaixaBtn" class="btn btn-primary" form="caixaForm">üíæ Salvar Caixa</button>
            </div>
        </div>
    </div>

    <!-- Modal Testar Todas as Conex√µes -->
    <div id="testAllModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üîç Teste de Todas as Conex√µes</h2>
                <span class="close" onclick="closeTestAllModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="test-progress">
                    <div class="progress-info">
                        <span id="testProgress">Preparando testes...</span>
                        <button id="startTestAll" class="btn btn-primary">‚ñ∂Ô∏è Iniciar Testes</button>
                    </div>
                </div>
                
                <div id="testResultsList" class="test-results-container">
                    <!-- Lista de resultados ser√° preenchida dinamicamente -->
                </div>
            </div>
        </div>
    </div>

    <script src="renderer.js"></script>
</body>
</html>